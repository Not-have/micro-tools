#!/usr/bin/env bash
. "$(dirname -- "$0")/_/husky.sh"

check_branch() {
  branch="$(git rev-parse --abbrev-ref HEAD)"

  # 允许的分支：master/main/develop 或符合特定格式
  if [[ "$branch" != "master" && "$branch" != "main" && "$branch" != "develop" ]]; then
    if [[ ! "$branch" =~ ^(feature|fix|chore|docs|test|perf|refactor)/[0-9]+\.[0-9]+\.[0-9]+(-[a-z0-9-]+)?$ ]]; then
      echo "Branch name \"$branch\" is not allowed to push

有效的分支名称示例：

  ✅ feature/1.1.0-some-new-stuff
  ✅ fix/1.0.1-fix-bug-xxx
  ✅ chore/1.2.0-setup-dev-stuff
  ✅ docs/1.0.2-update-readme
  ✅ test/1.0.3-unit-test-for-xx
  ✅ perf/1.3.0-improve-performance
  ✅ refactor/2.0.0-refactor-xx

How to Fix

  1. git branch -m <正确的分支名>
  2. git push -u origin <good_branch_name>"
      
      exit 1
    fi
  fi
}

check_branch
